<div>
  <button (click)="onclick()">Export</button>
  <ejs-diagram
    #diagram
    id="diagram"
    width="100%"
    height="900px"
    (created)="created()"
    [scrollSettings]="scrollSettings"
    [getConnectorDefaults]="connDefaults"
    [getNodeDefaults]="nodeDefaults"
    [layout]="layout"
    [dataSourceSettings]="data"
    [tool]="tool"
    [snapSettings]="snapSettings"
    (wheel)="onWheel($event)"
  >
    <ng-template #nodeTemplate let-data>
      <ng-container>
        <div
          class="nodeitem"
          id="nodeitem"
          [style.border]="
            data.data.objectType == 'MatrixPos' ? 'dotted 5px' : 'solid'
          "
          [style.border-color]="
            data.data.objectType == 'Position'
              ? data.data.backgroundColor
              : data.data.objectType == 'MatrixPos'
              ? 'orange'
              : 'green'
          "
          style="
            height: 100%;
            align-items: center;
            justify-content: center;
            background-color: white;
            box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
            border-radius: 20px;
            width: 100%;
            color: white;
          "
        >
          <div style="display: flex; flex-direction: column">
            <div
              *ngIf="
                data.data.objectType == 'Position' ||
                data.data.objectType == 'MatrixPos'
              "
            >
              <img
                alt="profile"
                [src]="data.data.pictureUrl"
                style="
                  width: 80px;
                  height: 80px;
                  border-radius: 50%;
                  left: 50%;
                  transform: translate(-50%, -60%);
                  position: absolute;
                "
              />
              <span
                [style.background-color]="
                  data.data.assignType == 'cch_AssignTypePermanent'
                    ? '#7286D3'
                    : data.data.assignType == 'cch_AssignTypeSecondment'
                    ? '#B9F3FC'
                    : data.data.assignType == 'cch_AssignTypeTemporary'
                    ? '#F6995C'
                    : '#E5E0FF'
                "
                class="dotChartDiagram"
              >
              </span>
            </div>
            <div
              *ngIf="
                data.data.objectType == 'Position' ||
                data.data.objectType == 'MatrixPos'
              "
            >
              <div
                style="
                  display: flex;
                  flex-direction: column;
                  row-gap: 1px;
                  padding: 30px 30px;
                  margin-top: 20px;
                "
              >
                <span
                  *ngIf="
                    CheckVisible('PersonNameDisplay') ||
                    CheckVisible('nickNameDisplay')
                  "
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 20px;
                    font-weight: bold;
                    text-align: center;
                  "
                  >{{
                    data.data.personNameDisplay != null
                      ? data.data.personNameDisplay
                      : "-"
                  }}
                  {{
                    data.data.nickNameDisplay != null
                      ? "(" + data.data.nickNameDisplay + ")"
                      : "-"
                  }}</span
                >
                <span
                  *ngIf="CheckVisible('personName2Display')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 20px;
                    text-align: center;
                    font-weight: bold;
                    margin-top: 5px;
                  "
                  >{{
                    data.data.personName2Display != null
                      ? data.data.personName2Display
                      : "-"
                  }}</span
                >
                <span
                  *ngIf="CheckVisible('empCode')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 20px;
                    text-align: center;
                    margin-top: 10px;
                    margin-bottom: 10px;
                  "
                >
                  {{ data.data.empCode }} - {{ data.data.hiredDateDisplay }}
                </span>
                <span style="margin-top: 10px; margin-bottom: 10px"></span>
                <span
                  *ngIf="CheckVisible('positionName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">ตำแหน่ง :</span
                  ><span style="text-align: right">
                    {{
                      data.data.objectName != null ? data.data.objectName : "-"
                    }}</span
                  >
                </span>
                <span
                  *ngIf="CheckVisible('unitCodeShortName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">หน่วยงาน :</span
                  ><span style="text-align: right">
                    {{
                      data.data.unitCodeName != null
                        ? data.data.unitCodeName +
                          "(" +
                          data.data.unitCodeShortName +
                          ".)"
                        : "-"
                    }}
                  </span>
                </span>
                <span
                  *ngIf="CheckVisible('companyName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">บริษัท :</span
                  ><span style="text-align: right">
                    {{
                      data.data.companyName != null
                        ? data.data.companyName
                        : "-"
                    }}</span
                  >
                </span>
                <span
                  *ngIf="CheckVisible('officeName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">สถานที่ปฏิบัติการ :</span
                  ><span style="text-align: right">
                    {{
                      data.data.officeName != null ? data.data.officeName : "-"
                    }}</span
                  >
                </span>
                <span
                  *ngIf="CheckVisible('personnelGradeName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">ระดับถือครอง :</span
                  ><span style="text-align: right">
                    {{
                      data.data.personnelGradeName != null
                        ? data.data.personnelGradeName
                        : "-"
                    }}</span
                  >
                </span>
                <span
                  *ngIf="CheckVisible('positionLevelName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">ระดับตำแหน่ง :</span
                  ><span style="text-align: right">
                    {{
                      data.data.positionLevelName != null
                        ? data.data.positionLevelName
                        : "-"
                    }}</span
                  >
                </span>
                <span
                  *ngIf="CheckVisible('positionExecutiveName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">ตำแหน่งบริหาร :</span
                  ><span style="text-align: right">
                    {{
                      data.data.positionExecutiveName != null
                        ? data.data.positionExecutiveName
                        : "-"
                    }}</span
                  >
                </span>
                <span
                  *ngIf="CheckVisible('positionWorkLineName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">ตำแหน่งสายงาน :</span
                  ><span style="text-align: right">
                    {{
                      data.data.positionWorkLineName != null
                        ? data.data.positionWorkLineName
                        : "-"
                    }}</span
                  >
                </span>
                <span
                  *ngIf="CheckVisible('positionRoleName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">ประเภทตำแหน่ง :</span
                  ><span style="text-align: right">
                    {{
                      data.data.positionRoleName != null
                        ? data.data.positionRoleName
                        : "-"
                    }}</span
                  >
                </span>
                <span
                  *ngIf="CheckVisible('jobFamilyName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">กลุ่ม Job :</span
                  ><span style="text-align: right">
                    {{
                      data.data.jobFamilyName != null
                        ? data.data.jobFamilyName
                        : "-"
                    }}</span
                  >
                </span>
                <span
                  *ngIf="CheckVisible('jobItemName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">Job :</span
                  ><span style="text-align: right">
                    {{
                      data.data.jobItemName != null
                        ? data.data.jobItemName
                        : "-"
                    }}</span
                  >
                </span>
                <span
                  *ngIf="CheckVisible('jobLevelName')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">ระดับ Job :</span
                  ><span style="text-align: right">
                    {{
                      data.data.jobLevelName != null
                        ? data.data.jobLevelName
                        : "-"
                    }}</span
                  >
                </span>
                <span
                  *ngIf="CheckVisible('costCenter')"
                  style="
                    color: rgb(0, 0, 0);
                    font-size: 15px;
                    display: flex;
                    justify-content: space-between;
                  "
                  ><span style="text-align: left">ศูนย์ต้นทุน :</span
                  ><span style="text-align: right">
                    {{
                      data.data.costCenter != null ? data.data.costCenter : "-"
                    }}</span
                  >
                </span>
              </div>
            </div>
          </div>
        </div>
      </ng-container>
    </ng-template>
  </ejs-diagram>
</div>
